# waterfall-sinanews

- 主要运用了瀑布流+懒加载

### 懒加载实现原理

- 判断元素是否在视野中，可以通过判断”元素到内容顶部的距离 <= 滚动距离 + 窗口距离    “即如下图：
![](http://ww1.sinaimg.cn/large/a0293cd1gy1fpmw84uafej208y09pgln.jpg)

### 瀑布流布局
- 宽度一致，而高度不一样的布局就是瀑布流布局

1. 先通过计算一排里面可以容纳多少列元素。
2. 然后再判断哪一列元素的高度最短，就将下一个元素放到该列。
3. 之后再判断放入该元素之后所形成的新的整排元素内，哪一列元素最短，再把下一个元素放置该列，以此类推。

- 关键变量是一个数组，存储的是当前每一列的高度之和。

### 细节处理
- 图片加载完全之后再判断元素的高度
- 数据是临时出现的，colSumHeight不能每次都初始化为空，要承接下一次的数据
- 由于看到元素就加载数据，又因为绝对定位使得数据加载出现问题，应该设置`$('ul').height(Math.max.apply(null, colSumHeight));`，使得元素在底部
